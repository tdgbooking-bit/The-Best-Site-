<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Profile â€” SUBLIMINAL WORLD</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body { background: #111; color: #fff; font-family: 'Playfair Display', serif; display: flex; align-items: center; justify-content: center; min-height: 100vh; margin: 0; }
    .profile-container { background: #222; padding: 40px 32px; border-radius: 10px; box-shadow: 0 4px 24px rgba(0,0,0,0.4); width: 400px; text-align: center; }
    .profile-email { color: #aaa; font-size: 15px; margin-bottom: 12px; }
    .profile-points { color: #0f0; font-size: 22px; margin: 18px 0; }
    .claimed-orders { color: #fff; font-size: 15px; margin-top: 18px; }
    .claimed-orders li { color: #ccc; font-size: 14px; }
  </style>
</head>
<body>
  <video autoplay muted loop playsinline class="video-bg" style="position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:-1;object-fit:cover;">
    <source src="../iStock-2253622537.mp4" type="video/mp4">
  </video>
  <div class="profile-container">
    <h1>Your Profile</h1>
    <div class="profile-email" id="profile-email"></div>
    <div class="profile-points" id="profile-points"></div>
    <div class="claimed-orders">
      <b>Claimed Orders:</b>
      <ul id="orders-list"></ul>
    </div>
    <button id="logout-btn" style="margin-top:24px;padding:10px 24px;border-radius:4px;background:#fff;color:#111;font-weight:bold;cursor:pointer;">Logout</button>
  </div>
  <script>
    // Find user by email in claims
    let email = '';
    let points = 0;
    let orders = [];
    // Try to get from login
    const currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
    if (currentUser && currentUser.email) {
      email = currentUser.email;
      // Get user info from users
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      const user = users.find(u => u.email === email);
      if (user) {
        points = user.points || 0;
        orders = user.orders || [];
      }
    }
    document.getElementById('profile-email').innerText = email ? 'Email: ' + email : 'Not logged in.';
    document.getElementById('profile-points').innerText = 'Points: ' + points;
    const ordersList = document.getElementById('orders-list');
    orders.forEach(order => {
      const li = document.createElement('li');
      let items = '';
      if(order.items && order.items.length > 0){
        items = order.items.map(i => `${i.name} ($${i.price})`).join(', ');
      }
      li.innerHTML = `<b>Date:</b> ${order.date || ''}<br><b>Items:</b> ${items}<br><b>Phone:</b> ${order.phone || ''}`;
      ordersList.appendChild(li);
    });
    document.getElementById('logout-btn').onclick = function() {
      localStorage.removeItem('currentUser');
      window.location.href = 'login.html';
    };
  </script>
</body>
</html>
